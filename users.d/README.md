# Пользователи ClickHouse

Этот XML-файл определяет конфигурацию пользователей, профилей доступа и квот для СУБД ClickHouse.
Конфигурация лежит в: `/etc/clickhouse-server/users.d/my-user.xml`

## 1. Пользователи (`<users>`)

Определены два пользователя:

### **test**
- **Пароль:** `Qq123456`
- **Права:** нет управления доступом (`access_management=0`)
- **Доступ:** с любых IP-адресов (`0.0.0.0/0`)
- **Профиль:** `test-profile` (жёсткие ограничения на результат, разрешена запись)
- **Квота:** `default` (без ограничений)
- **Ограничения на таблицу logs:** закомментированы (не активны)

### **superuser**
- **Пароль:** `Qq1234567`
- **Права:** полные (управление доступом, создание/удаление БД, таблиц, представлений и т.д.)
- **Дополнительно:** разрешены introspection-функции и просмотр настроек
- **Доступ:** с любых IP-адресов
- **Профиль:** `default`
- **Квота:** `default`

---

## 2. Профили (`<profiles>`)

Определены три профиля выполнения запросов:

### **default**
- Базовые настройки без ограничений
- Не использует кеш несжатых данных (`use_uncompressed_cache=0`)
- Балансировка нагрузки: случайная (`random`)

### **myprofile**
- Ограничения на использование памяти (20GB), чтение строк/байт
- Максимум 1 млн строк в результате
- Только чтение (`readonly=1`)
- **Не используется ни одним пользователем**

### **test-profile**
- Аналогичен `myprofile`, но:
  - Ограничение в 1 строку результата (`max_result_rows=1`)
  - Разрешена запись (`readonly=0`)
- **Используется пользователем `test`**

---

## 3. Квоты (`<quotas>`)

Определены две квоты:

### **default**
- Без ограничений (все значения 0)
- **Назначена обоим пользователям**

### **test-quota**
- Два интервала ограничений:
  - **Краткосрочные (2 минуты):**
    - Макс. 3 запроса
    - Макс. 2 ошибки
    - 10k строк результата
  - **Долгосрочные (24 часа):**
    - Макс. 1000 запросов
    - 100 ошибок
    - 1 млрд строк результата
- **Не назначена ни одному пользователю**

---

## Итог

- Два пользователя: ограниченный `test` (жёсткие ограничения на результат, разрешена запись) и привилегированный `superuser`
- Три профиля выполнения запросов с разными уровнями ограничений (один из них не используется)
- Две системы квот: без ограничений (используется) и с жёсткими лимитами (не используется)